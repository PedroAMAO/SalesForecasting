ğŸ“ˆ Plataforma de PrevisÃ£o de Vendas â€” TendÃªncia + ARIMA + Machine Learning

Este projeto implementa um sistema completo de previsÃ£o de vendas, combinando:

Modelo ClÃ¡ssico (tendÃªncia + sazonalidade mÃ©dia),

ARIMA (modelagem de ruÃ­do no log),

Meta-Modelo de Machine Learning (XGBoost com lags, deltas e erros histÃ³ricos),

Rolling Evaluation (1-step ahead) â€” totalmente realista, sem vazamento,

InterpretaÃ§Ã£o AutomÃ¡tica via LLM,

ExportaÃ§Ã£o de RelatÃ³rio Profissional em PDF.

Tudo Isso dentro de uma aplicaÃ§Ã£o Streamlit simples de operar.

ğŸš€ Funcionalidades Principais
ğŸ”¹ 1. Upload de base

O app lÃª um .xlsx com as colunas:

Ano

MÃªs

Filial

Realizado

O sistema aceita variaÃ§Ãµes de maiÃºsculas/minÃºsculas e nomes alternativos.

ğŸ”¹ 2. PrÃ©-processamento automÃ¡tico

O pipeline automaticamente:

Converte ano/mÃªs para datas mensais (YYYY-MM-01)

Calcula participaÃ§Ã£o da filial (â€œReal Share %â€) caso desejado

Organiza sÃ©rie temporal

Cria coluna t (Ã­ndice temporal)

Limpa e padroniza colunas

ğŸ”¹ 3. TrÃªs Modelos de PrevisÃ£o
ğŸ“Œ Modelo ClÃ¡ssico

Baseado em:

TendÃªncia linear, quadrÃ¡tica ou mÃ©dia

Sazonalidade mÃ©dia histÃ³rica

Intervalo de confianÃ§a via ruÃ­do estrutural

ğŸ“Œ ARIMA (ResÃ­duos)

Modela o ruÃ­do do log da sÃ©rie depois de tirar tendÃªncia + sazonalidade.

Com:

ARIMA manual (p,d,q)

OU otimizaÃ§Ã£o automÃ¡tica (grid + rolling-origin cross-validation)

ğŸ“Œ Meta-Modelo ML (XGBoost)

Utiliza:

Lags de Y

Lags do clÃ¡ssico e ARIMA

Erros passados

Deltas

Features sazonais (sen/cos)

PrevisÃ£o recursiva sem vazamento

ğŸ¨ VisualizaÃ§Ãµes

O app gera um grÃ¡fico master:

Realizado (barras)

ClÃ¡ssico (linha preta + banda de IC futuro)

ARIMA (azul + banda de IC)

ML (roxo)

Corte (linha vertical vermelha)

ğŸ“˜ MÃ©tricas
â¤ PerÃ­odo Completo

MAPE (%)

RÂ²

RMSE

â¤ PÃ³s-Corte

Mostra apenas meses cuja previsÃ£o realmente importa.

ğŸ” Rolling Evaluation (Realista)

O app implementa o rolling 1-step ahead, onde, para cada mÃªs t:

Treina o modelo usando apenas dados atÃ© t

PreveÌ‚ t+1

Guarda erro realista (sem vazamento)

DisponÃ­vel para:

ClÃ¡ssico

ARIMA

ML (se ativado)

Gera:

MAPE mÃ©dio

Erro mÃ©dio absoluto

GrÃ¡fico por data de corte

ğŸ§© InterpretaÃ§Ã£o AutomÃ¡tica via LLM

A aplicaÃ§Ã£o monta um prompt consultivo analisando:

Qual modelo performou melhor e por quÃª

Leitura dos intervalos de confianÃ§a

Comportamento pÃ³s-corte

ExplicaÃ§Ã£o da Rolling Evaluation

Insights estratÃ©gicos para o gestor

O usuÃ¡rio pode anexar um PDF de contexto (opcional), e o texto serÃ¡ incorporado.

ğŸ“„ ExportaÃ§Ã£o em PDF

Gera um relatÃ³rio completo contendo:

GrÃ¡fico

MÃ©tricas

InterpretaÃ§Ã£o do LLM

Tabela resumo dos modelos

PDF Ã© totalmente formatado via reportlab.

ğŸ› ï¸ InstalaÃ§Ã£o

Crie seu ambiente e instale as dependÃªncias:

pip install -r requirements.txt

â–¶ï¸ ExecuÃ§Ã£o
streamlit run Previsao_Vendas3.py

ğŸ“‚ Estrutura Sugerida do Projeto
ğŸ“ previsao-vendas
â”‚
â”œâ”€â”€ Previsao_Vendas3.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ README.md
â””â”€â”€ exemplos/
    â””â”€â”€ base_vendas.xlsx

âš™ï¸ Requirements
streamlit
numpy
pandas
matplotlib
scikit-learn
statsmodels
xgboost
reportlab
pymupdf
openai
python-dateutil
